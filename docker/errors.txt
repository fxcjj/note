[source]
192.168.6.131

[]




# 查看所有已创建的容器
[root@localhost /]# docker container ls -a
CONTAINER ID        IMAGE                       COMMAND                  CREATED             STATUS                      PORTS               NAMES
2fc81398dcb0        registry                    "/entrypoint.sh /e..."   12 hours ago        Created                                         modest_bassi
3e4f061fdb1b        victoralbert/nginx_web:v1   "nginx -g 'daemon ..."   29 hours ago        Exited (0) 21 seconds ago                       nginx_web
9f05e95d90ca        mysql:5.6                   "docker-entrypoint..."   33 hours ago        Exited (0) 7 minutes ago                        mysql5.6
# 查看所有正在运行的容器
[root@localhost /]# docker container ls
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
# 启动modest_bassi容器
[root@localhost /]# docker container start modest_bassi
Error response from daemon: oci runtime error: container_linux.go:235: starting container process caused "container init exited prematurely"
Error: failed to start containers: modest_bassi






root@9f05e95d90ca:/# find / -name mysql
/etc/init.d/mysql
/etc/mysql
find: '/proc/acpi': Permission denied
find: '/proc/scsi': Permission denied
find: '/proc/1/map_files': Operation not permitted
find: '/proc/54/map_files': Operation not permitted
find: '/proc/69/map_files': Operation not permitted
find: '/sys/firmware': Permission denied
/usr/bin/mysql
/usr/lib/mysql
/usr/share/mysql
/var/lib/mysql
/var/lib/mysql/mysql
/var/log/mysql



centos7下docker registry push 提示“server gave HTTP response to HTTPS client”
https://blog.csdn.net/wzr54321/article/details/79400059



3. 安装好docker registry之后，push镜像出现如下问题

[root@localhost /]# docker push 192.168.6.131:5000/myfirstimage
The push refers to a repository [192.168.6.131:5000/myfirstimage]
Get https://192.168.6.131:5000/v1/_ping: http: server gave HTTP response to HTTPS client


原因：
Docker自从1.3.X之后docker registry交互默认使用的是HTTPS，但是搭建私有镜像默认使用的是HTTP服务，所以与私有镜像交时出现以上错误。


方案1：
在docker server启动的时候，增加启动参数，默认使用HTTP访问：

vi /usr/lib/systemd/system/docker.service

找到
ExecStart=/usr/bin/dockerd
修改为
ExecStart=/usr/bin/dockerd --insecure-registry 192.168.6.131:5000


修改好后重启docker服务
systemctl daemon-reload 
systemctl restart docker

方案2：
如果方案1解决不了，使用方案2。

# 编辑docker配置文件，如果不存在新建
vi /etc/docker/daemon.json
{
"insecure-registries":["192.168.6.131:5000"]
}

保存退出。


方案3：
修改默认文件（我的机器没有）
vi /etc/default/docker

修改：
DOCKER_OPTS="--registry-mirror=https://registry.docker-cn.com --insecure-registry=192.168.188.112:5000"

note
window server 2016，默认安装docker的配置文件在“C:\ProgramData\docker\config\”。
可以在该目录下创建”daemon.json“文件，解决此问题。


参考
https://www.cnblogs.com/lkun/p/7990466.html




4. push镜像出现 dial tcp 192.168.6.131:5000: connect: connection refused
[root@localhost system]# docker push 192.168.6.131:5000/myfirstimage
The push refers to a repository [192.168.6.131:5000/myfirstimage]
Put http://192.168.6.131:5000/v1/repositories/myfirstimage/: dial tcp 192.168.6.131:5000: connect: connection refused






docker push 192.168.6.131:5000/myfirstimage

{
"registry-mirrors": ["http://*******.m.daocloud.io"],
"dns": ["8.8.8.8","8.8.8.4"],
"insecure-registries":["192.168.6.131:5000"]
}



[root@localhost docker]# systemctl restart docker
Job for docker.service failed because the control process exited with error code. See "systemctl status docker.service" and "journalctl -xe" for details.